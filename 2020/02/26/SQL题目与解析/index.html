<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="SQL题目与解析, 数据分析、机器学习、统计学、股票、生活、京剧、数据库、Python">
    <meta name="description" content="SQL练习题与解析author：Yuhao Wang
last_update_time：2020-02-25
一、练习说明对于大多数小伙伴来说， 最主要的是查询语句的使用。想要真正的掌握SQL，最好的方法就是不断的刷题，逐步强化锻炼你对于S">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>SQL题目与解析 | 从来只看自己</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    
    <script src="/libs/jquery/jquery.min.js"></script>
    
<link rel="alternate" href="/atom.xml" title="从来只看自己" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper head-container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">从来只看自己</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">从来只看自己</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/RomanticDW" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #693fb5;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/RomanticDW" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/17.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        SQL题目与解析
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #c993b7;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #c993b7;
    }

    #toc-content .is-active-link::before {
        background-color: #c993b7;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/SQL/">
                                <span class="chip bg-color">SQL</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/SQL/" class="post-category">
                                SQL
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-02-26
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2020-02-26
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    9.8k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    41 分
                </div>
                
				
                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
            
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="SQL练习题与解析"><a href="#SQL练习题与解析" class="headerlink" title="SQL练习题与解析"></a>SQL练习题与解析</h1><p>author：Yuhao Wang</p>
<p>last_update_time：2020-02-25</p>
<h2 id="一、练习说明"><a href="#一、练习说明" class="headerlink" title="一、练习说明"></a>一、练习说明</h2><p>对于大多数小伙伴来说， 最主要的是查询语句的使用。想要真正的掌握SQL，最好的方法就是不断的刷题，逐步强化锻炼你对于SQL的<strong>结构化思维</strong>，这一点非常重要。</p>
<p>刷题的方式有两种：</p>
<p>第一种：在数据库中建好数据表并导入数据，然后在查询环境中书写SQL提交查询。这种方式更适合初学者，因为每次提交SQL语句后，编译器都会对你的SQL进行解析，如果书写错误会及时提示，告诉你错在什么地方以便于你进一步调试。</p>
<p>第二种：直接看表结构，然后直接在本子上或者编辑工具中写SQL，在你确认无误后直接对照答案检查。这种方式直接跳过了机器检验，更考验你对SQL的熟悉程度。当你有一定的基础后，我更推荐这种方式。</p>
<p>最后提两点大家在书写SQL时的小建议，养成良好的习惯也至关重要：</p>
<ul>
<li><strong>写注释</strong>：对于初学者而言，写注释可以帮你<strong>理清思路</strong>；对于有一定基础的小伙伴而言，注释可以快速帮你理解复杂SQL的作用，极大提升工作效率</li>
<li><strong>注意缩进</strong>：对于复杂SQL来说，好的缩进层次可以<strong>极大的提升阅读体验</strong>，也可以令SQL看起来简洁有序。</li>
</ul>
<h2 id="二、在线练习网站推荐"><a href="#二、在线练习网站推荐" class="headerlink" title="二、在线练习网站推荐"></a>二、在线练习网站推荐</h2><p>这里推荐几个在线SQL学习网站(排名不分先后，点击名称即可跳转)：</p>
<ol>
<li><a href="https://sqlzoo.net/" target="_blank" rel="noopener">sqlzoo</a>：这个网站包括了SQL学习的教程和参考资料，支持多种SQL搜索引擎且支持多过语言， 题目由易到难。</li>
<li><a href="https://sqlbolt.com/" target="_blank" rel="noopener">SQLBolt</a>： SQLBolt 是一个适合小白学习 SQL 的网站，这里由浅及深的介绍了 SQL 的知识，每一个章节是一组相关的 SQL 知识点，且配备着相应的练习，唯一的缺点是英文的。</li>
<li><a href="http://xuesql.cn" target="_blank" rel="noopener">xuesql.cn</a>：相当于 SQLBolt 的中文版，包含视频、手册、在线练习。 </li>
<li><a href="https://leetcode-cn.com" target="_blank" rel="noopener">leetcode</a>：不仅可用于刷算法题，也有关于SQL的题目，提交答案后在线测评，也会让你很直观的看到自己所写的 SQL 的运行速度等。设有讨论区，可以去借鉴别人优化好的 SQL</li>
<li><a href="https://www.nowcoder.com/" target="_blank" rel="noopener">牛客网</a>：与leetcode相似，可以在线提交与测评。</li>
</ol>
<h2 id="三、练习数据准备"><a href="#三、练习数据准备" class="headerlink" title="三、练习数据准备"></a>三、练习数据准备</h2><h3 id="数据导入"><a href="#数据导入" class="headerlink" title="数据导入"></a>数据导入</h3><p>本文题目大部分出牛客网<a href="https://www.nowcoder.com/ta/sql?page=0" target="_blank" rel="noopener">数据库专题</a>，大家可以进入网站自行练习，也可以在自己的电脑上<strong>导入数据集</strong>，这里需安装<code>MySQL</code>客户端与<code>Navicat</code>(非必须)。牛客网的搜索引擎为<code>SQLite</code>，少部分语法与<code>MySQL</code>不兼容，个人更倾向于离线本地学习，这样可以顺便对SQL中的建表也有一定的了解。测试数据集我放在<a href="https://pan.baidu.com/s/16Lnl1D4y4ITlaohNdePZGw" target="_blank" rel="noopener">网盘</a>，提取码：0gad，大家自取。导入数据的方式可以通过在<code>Navicate</code>中<code>右击数据库名</code>后点击<code>运行SQL文件</code>，可以以直接运行脚本内的SQL，在此不再赘述，另外本文的题目主要是查询类题目，如果大家想了解对于数据库、数据表、数据列的操作，可以看我的另外一篇文章。</p>
<h3 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h3><p>这里简要给大家列举一下会用到的数据库表结构，方便大家做题的时候对照查看。</p>
<h4 id="employees-员工表"><a href="#employees-员工表" class="headerlink" title="employees 员工表"></a><code>employees</code> 员工表</h4><p>该表存放员工的基本信息</p>
<table>
<thead>
<tr>
<th>列名</th>
<th>字段类型</th>
<th>是否为空</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>emp_no</code></td>
<td>int(11)</td>
<td>否</td>
<td>员工ID，主键</td>
</tr>
<tr>
<td><code>birth_date</code></td>
<td>date</td>
<td>否</td>
<td>生日</td>
</tr>
<tr>
<td><code>first_name</code></td>
<td>varchar(14)</td>
<td>否</td>
<td>姓</td>
</tr>
<tr>
<td><code>last_name</code></td>
<td>varchar(16)</td>
<td>否</td>
<td>名</td>
</tr>
<tr>
<td><code>gender</code></td>
<td>char(1)</td>
<td>否</td>
<td>性别</td>
</tr>
<tr>
<td><code>hire_date</code></td>
<td>date</td>
<td>否</td>
<td>雇佣日期</td>
</tr>
</tbody></table>
<h4 id="dept-manager-部门领导表"><a href="#dept-manager-部门领导表" class="headerlink" title="dept_manager 部门领导表"></a><code>dept_manager</code> 部门领导表</h4><p>该表存放每个部门的领导信息，使用<code>dept_no</code>与<code>emp_no</code>作为复合主键</p>
<table>
<thead>
<tr>
<th>列名</th>
<th>字段类型</th>
<th>是否为空</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>dept_no</code></td>
<td>char(4)</td>
<td>否</td>
<td>部门ID</td>
</tr>
<tr>
<td><code>emp_no</code></td>
<td>int(11)</td>
<td>否</td>
<td>员工ID</td>
</tr>
<tr>
<td><code>from_date</code></td>
<td>date</td>
<td>否</td>
<td>开始日期</td>
</tr>
<tr>
<td><code>to_date</code></td>
<td>date</td>
<td>否</td>
<td>结束日期</td>
</tr>
</tbody></table>
<p><strong>提问</strong>：为何要使用使用<code>dept_no</code>与<code>emp_no</code>作为复合主键？</p>
<p>举例说明：雇员A在2016年至2018年为部门A的领导，在2018-2019年为部门B的领导，2020年至今为部门C的领导，则雇员A在<code>dept_manager</code> 中存在3条记录，且最后一条记录(2020年至今)的<code>to_date</code>为’9999-01-01’，因此要使用复合主键才能唯一确定一条记录。</p>
<p><strong>扩展</strong>：这种数据模型在数据仓库的设计过程中被称为<a href="https://blog.csdn.net/saqin6255/article/details/80362248" target="_blank" rel="noopener">拉链表</a>。既能满足反应数据的历史状态， 又可以最大程度的节省存储 </p>
<h4 id="salaries-薪水表"><a href="#salaries-薪水表" class="headerlink" title="salaries 薪水表"></a><code>salaries</code> 薪水表</h4><p>该表存放所有雇员的薪水信息。使用<code>emp_no</code>与<code>from_date</code>作为复合主键，原因与上表相同</p>
<table>
<thead>
<tr>
<th>列名</th>
<th>字段类型</th>
<th>是否为空</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>emp_no</code></td>
<td>int(11)</td>
<td>否</td>
<td>员工ID</td>
</tr>
<tr>
<td><code>salary</code></td>
<td>int(11)</td>
<td>否</td>
<td>薪水</td>
</tr>
<tr>
<td><code>from_date</code></td>
<td>date</td>
<td>否</td>
<td>开始日期</td>
</tr>
<tr>
<td><code>to_date</code></td>
<td>date</td>
<td>否</td>
<td>结束日期</td>
</tr>
</tbody></table>
<h4 id="dept-emp-部门员工表"><a href="#dept-emp-部门员工表" class="headerlink" title="dept_emp 部门员工表"></a><code>dept_emp</code> 部门员工表</h4><p>该表存放部门与雇员的对应信息。使用<code>emp_no</code>与<code>dept_no</code>作为复合主键</p>
<table>
<thead>
<tr>
<th>列名</th>
<th>字段类型</th>
<th>是否为空</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>emp_no</code></td>
<td>int(11)</td>
<td>否</td>
<td>员工ID</td>
</tr>
<tr>
<td><code>dept_no</code></td>
<td>char(4)</td>
<td>否</td>
<td>部门ID</td>
</tr>
<tr>
<td><code>from_date</code></td>
<td>date</td>
<td>否</td>
<td>开始日期</td>
</tr>
<tr>
<td><code>to_date</code></td>
<td>date</td>
<td>否</td>
<td>结束日期</td>
</tr>
</tbody></table>
<h4 id="titles-职称表"><a href="#titles-职称表" class="headerlink" title="titles 职称表"></a><code>titles</code> 职称表</h4><p>该表存放雇员与职称的对应信息。使用<code>emp_no</code>与<code>from_date</code>作为复合主键</p>
<table>
<thead>
<tr>
<th>列名</th>
<th>字段类型</th>
<th>是否为空</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>emp_no</code></td>
<td>int(11)</td>
<td>否</td>
<td>员工ID</td>
</tr>
<tr>
<td><code>title</code></td>
<td>varchar(50)</td>
<td>否</td>
<td>职称</td>
</tr>
<tr>
<td><code>from_date</code></td>
<td>date</td>
<td>否</td>
<td>开始日期</td>
</tr>
<tr>
<td><code>to_date</code></td>
<td>date</td>
<td>否</td>
<td>结束日期</td>
</tr>
</tbody></table>
<h4 id="emp-bonus-奖金表"><a href="#emp-bonus-奖金表" class="headerlink" title="emp_bonus 奖金表"></a><code>emp_bonus</code> 奖金表</h4><p>该表存放雇员与对应的奖金信息。</p>
<table>
<thead>
<tr>
<th>列名</th>
<th>字段类型</th>
<th>是否为空</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>emp_no</code></td>
<td>int(11)</td>
<td>否</td>
<td>员工ID</td>
</tr>
<tr>
<td><code>recevied</code></td>
<td>datetime</td>
<td>否</td>
<td>发放时间</td>
</tr>
<tr>
<td><code>btype</code></td>
<td>smallint</td>
<td>否</td>
<td>奖金类型（1、2、3）</td>
</tr>
</tbody></table>
<h4 id="departments-部门表"><a href="#departments-部门表" class="headerlink" title="departments 部门表"></a><code>departments</code> 部门表</h4><p>该表存放部门的信息。</p>
<table>
<thead>
<tr>
<th>列名</th>
<th>字段类型</th>
<th>是否为空</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>dept_no</code></td>
<td>char(4)</td>
<td>否</td>
<td>部门ID，主键</td>
</tr>
<tr>
<td><code>dept_name</code></td>
<td>varchar(40)</td>
<td>否</td>
<td>部门名称</td>
</tr>
</tbody></table>
<h2 id="四、题目"><a href="#四、题目" class="headerlink" title="四、题目"></a>四、题目</h2><p>建议小伙伴们在做题的时候先把解题思路遮住，自己思考并尝试自己写，最后再与答案对照。另外很多题目<strong>解题方式不唯一</strong>，答案与解题思路仅供参考。</p>
<h3 id="1-入职最晚的员工"><a href="#1-入职最晚的员工" class="headerlink" title="1 入职最晚的员工"></a>1 入职最晚的员工</h3><p><strong>题目描述</strong>： 在员工表中查找最晚入职员工的所有信息</p>
<p><strong>解题思路</strong>：</p>
<p>先找出所有入职时间里最大(最晚)的时间，在使用子查询的方式查找入职时间等于最晚时间的员工的所有信息，这样可以确保多条最晚入职的员工信息都可以被查询出来。 </p>
<pre class=" language-mysql"><code class="language-mysql">-- 第一种方式
SELECT * 
FROM employees
WHERE hire_date = (SELECT MAX(hire_date) 
                   FROM employees
                  );

-- 第二种方式
SELECT * 
FROM employees
WHERE hire_date = (SELECT hire_date 
                   FROM employees
                   ORDER BY hire_date DESC
                   LIMIT 1
                  );</code></pre>
<p><strong>注意：</strong>很多小伙伴可能会想到先对<code>hire_date</code>进行排序，然后使用<code>LIMIT=1</code>限制条数，但是使用<code>ORDER BY</code>按由大到小排序后选取第一条的方法仅限于当最晚入职数据只有一条时才正确，不能保证有多条同一最晚时间时的准确性。 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT * 
FROM employees
ORDER BY hire_date DESC
LIMIT 1; </code></pre>
<h3 id="2-入职时间排名倒数第三的员工"><a href="#2-入职时间排名倒数第三的员工" class="headerlink" title="2 入职时间排名倒数第三的员工"></a>2 入职时间排名倒数第三的员工</h3><p><strong>题目描述</strong>： 在员工表中查找入职员工时间排名倒数第三的员工所有信息</p>
<p><strong>解题思路</strong>：</p>
<p> 同样使用子查询方法找到排名倒数第三的<code>hire_date</code>。在子查询中关键是要<strong>用</strong><code>DISTINCT</code><strong>去重</strong>，去重后相同入职日期只会保留一个，此时使用<code>ORDER BY</code>进行排序，然后使用<code>LIMIT</code>选择排名倒数第三的<code>hire_date</code>。  </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT * 
FROM employees
WHERE hire_date = (
                    SELECT DISTINCT hire_date 
                    FROM employees
                    ORDER BY hire_date DESC 
                    LIMIT 2,1
                  );</code></pre>
<h3 id="3-领导的薪水"><a href="#3-领导的薪水" class="headerlink" title="3 领导的薪水"></a>3 领导的薪水</h3><p><strong>题目描述</strong>： <strong>查找各个部门当前领导<em>(to_date=’9999-01-01’)</em>当前薪水详情以及其对应部门编号<code>dept_no</code></strong> </p>
<p><strong>解题思路</strong>：</p>
<p> 通过<code>dept_manager</code>的<code>emp_no</code>=<code>salaries</code>的<code>emp_no</code>为联结条件联结两表，同时限制两表的<em>to_date = ‘9999-01-01’</em>筛选数据</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT s.*,d.dept_no
FROM salaries s 
JOIN dept_manager d ON s.emp_no = d.emp_no
WHERE d.to_date = '9999-01-01' 
  AND s.to_date = '9999-01-01';</code></pre>
<h3 id="4-所有员工的姓名与部门"><a href="#4-所有员工的姓名与部门" class="headerlink" title="4 所有员工的姓名与部门"></a>4 所有员工的姓名与部门</h3><p><strong>题目描述</strong>： 查找所有员工的<code>last_name</code>和<code>first_name</code>以及对应部门编号<code>dept_no</code>，也包括展示没有分配具体部门的员工</p>
<p><strong>解题思路</strong>：</p>
<p> 使用<code>employees</code>作为主表，使用左联结，比较简单。 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT e.last_name,e.first_name,d.dept_no
FROM employees e 
LEFT JOIN dept_emp d ON e.emp_no = d.emp_no;</code></pre>
<h3 id="5-已经分配部门的员工"><a href="#5-已经分配部门的员工" class="headerlink" title="5 已经分配部门的员工"></a>5 已经分配部门的员工</h3><p><strong>题目描述</strong>：  查找所有已经分配部门的员工的<code>last_name</code>和<code>first_name</code> </p>
<p><strong>解题思路</strong>：</p>
<p>这里考察<code>LEFT JOIN</code>的原理。使用<code>employees</code>作为主表<strong>左联结</strong><code>dept_emp</code>，题目要查找所有已经分配部门的员工，意味着联结后必须要带有<code>dept_no</code>，没有<code>dept_no</code>的就是还未分配部门的，因此加上筛选条件<code>dept_no</code>为空即可求得。 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT e.last_name,e.first_name
FROM employees e 
LEFT JOIN dept_emp d ON e.emp_no = d.emp_no
WHERE d.dept_no is not null;</code></pre>
<h3 id="6-员工入职时的薪水"><a href="#6-员工入职时的薪水" class="headerlink" title="6 员工入职时的薪水"></a>6 员工入职时的薪水</h3><p><strong>题目描述</strong>： 查找所有员工入职时候的薪水情况，给出<code>emp_no</code>以及<code>salary</code>， 并按照<code>emp_no</code>进行逆序</p>
<p><strong>解题思路</strong>：</p>
<p>使用左联结(内联结)，此题最关键的是<code>salaries</code>表的<code>from_date</code> 和 <code>employees</code>表的<code>hire_date</code> 的值应该要相等，因此有限制条件<code>e.hire_date = s.from_date</code>，两个<code>date</code>都是刚入职的时间。</p>
<p>再强调一下，<code>salaries</code>表中有多个相同<code>emp_no</code>的<code>salary</code>，即<code>emp_no</code>在<code>salaries</code>表中不唯一，因为同一员工在不同时间的工资不同，即涨薪或降薪。</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT e.emp_no,s.salary
FROM salaries s 
LEFT JOIN employees e ON s.emp_no = e.emp_no
WHERE e.hire_date = s.from_date
ORDER BY s.emp_no DESC;</code></pre>
<h3 id="7-员工当前薪水"><a href="#7-员工当前薪水" class="headerlink" title="7 员工当前薪水"></a>7 员工当前薪水</h3><p><strong>题目描述</strong>： 找出所有员工当前<em>(to_date=’9999-01-01’)</em>具体的薪水<code>salary</code>情况，最后只显示<code>salary</code>这一列，对于相同的薪水只显示一次,并按照逆序显示</p>
<p><strong>解题思路</strong>：</p>
<p>关键理解对于<strong>相同的薪水只显示一次</strong>，使用分组方法对<code>salary</code>进行分组求得，也可以使用<code>DISTINCT</code>去重的方法，但是一般数据较多时使用<code>DISTINCT</code>效率相比<code>GROUP BY</code> 要慢，所以从性能角度考虑，应该尽量使用<code>GROUP BY</code>。 </p>
<pre class=" language-mysql"><code class="language-mysql">-- 第一种方式 使用DISTINCT
SELECT DISTINCT salary
FROM salaries
WHERE to_date='9999-01-01'
ORDER BY salary DESC;

-- 第二种方式
SELECT salary
FROM salaries
WHERE to_date='9999-01-01'
GROUP BY salary
ORDER BY salary DESC;</code></pre>
<h3 id="8-领导当前薪水"><a href="#8-领导当前薪水" class="headerlink" title="8 领导当前薪水"></a>8 领导当前薪水</h3><p><strong>题目描述</strong>：  获取所有部门当前<code>manager</code>的当前薪水情况(<em>to_date=’9999-01-01’</em>)，给出<code>dept_no</code>, <code>emp_no</code>以及<code>salary</code></p>
<p><strong>解题思路</strong>：</p>
<p>注意理解题目，键点是有两个“当前”。因此<code>dept_manager</code>表的<code>to_date</code>和<code>salaries</code>表的<code>to_date</code>都要等于’9999-01-01’，<code>s.to_date = &#39;9999-01-01&#39;</code>容易理解，限定当前时间当前工资，<code>d.to_date = &#39;9999-01-01&#39;</code>则限定在职经理。</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT d.dept_no,d.emp_no,s.salary
FROM salaries s LEFT JOIN dept_manager d ON d.emp_no = s.emp_no
WHERE d.to_date = '9999-01-01' AND s.to_date = '9999-01-01';
</code></pre>
<h3 id="9-不是领导的员工"><a href="#9-不是领导的员工" class="headerlink" title="9 不是领导的员工"></a>9 不是领导的员工</h3><p><strong>题目描述</strong>：  获取所有非<code>manager</code>员工的<code>emp_no</code></p>
<p><strong>解题思路</strong>：</p>
<p> 使用<code>employees</code>作为主表，使用左联结，限定条件为<code>d.dept_no</code>为空，选出在<code>employees</code>中但不在<code>dept_manager</code>中的<code>emp_no</code>记录。 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT e.emp_no
FROM employees e 
LEFT JOIN dept_manager d ON e.emp_no = d.emp_no
WHERE d.dept_no is null;
</code></pre>
<h3 id="10-员工当前的领导"><a href="#10-员工当前的领导" class="headerlink" title="10 员工当前的领导"></a>10 员工当前的领导</h3><p><strong>题目描述</strong>：  获取所有员工的当前的<code>emp_no</code>与对应经理的<code>manager_no</code>，如果当前的<code>manager</code>是自己的话结果不显示，当前表示<code>to_date=&#39;9999-01-01&#39;</code>。</p>
<p><strong>解题思路</strong>：</p>
<p>重点要理解两表之间的逻辑关系和题目要求。有三个关键点：</p>
<ol>
<li><p>每个部门都有一个<code>manager</code>，每个人都有自己所在的部门。所以用部门号<code>dept_no</code>作为联结条件，左联结和内联结都可以；</p>
</li>
<li><p>如果员工当前的<code>manager</code>是自己的话结果不显示，这就要求<code>dept_emp</code>表的员工编号<code>emp_no</code>和<code>dept_manager</code>的员工编号不相等；</p>
</li>
<li><p>题目要求当前的<code>manager</code>，所以最后的经理表<code>dept_manager</code>的时间为<em>to_date=’9999-01-01’</em>，严谨起见，员工表<code>dept_emp</code>的时间也应该是<em>to_date=’9999-01-01’</em>。</p>
</li>
</ol>
<pre class=" language-mysql"><code class="language-mysql">SELECT
  de.emp_no,
  dm.emp_no AS manager_no 
FROM
  dept_emp de
LEFT JOIN dept_manager dm ON de.dept_no = dm.dept_no 
WHERE
  de.to_date = '9999-01-01'
AND dm.to_date = '9999-01-01'
AND de.emp_no <> dm.emp_no
</code></pre>
<h3 id="11-部门最高的员工薪水"><a href="#11-部门最高的员工薪水" class="headerlink" title="11 部门最高的员工薪水"></a>11 部门最高的员工薪水</h3><p><strong>题目描述</strong>： 获取所有部门中当前员工<strong>薪水最高</strong>的相关信息，给出<code>dept_no</code>, <code>emp_no</code>以及其对应的<code>salary</code></p>
<p><strong>解题思路</strong>：</p>
<p>STEP1：先用内联结或左联结连接两张表，限制条件是两张表的<code>emp_no</code>相同，即<code>d.emp_no = s.emp_no</code></p>
<p>STEP2：选取每个员工当前的工资水平，用<code>d.to_date = &#39;9999-01-01&#39; AND s.to_date = &#39;9999-01-01&#39;</code>作条件限制； </p>
<p>STEP3：用<code>GROUP BY</code>将每个部门分为一组，用<code>MAX()</code>函数选取每组中工资最高者； </p>
<p>STEP4：将<code>salaries</code>用s代替，<code>dept_emp</code>用d代替，最后将<code>MAX(s.salary)</code>用<code>salary</code>代替后输出。</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT
  d.dept_no,
  s.emp_no,
  MAX(s.salary) AS salary 
FROM salaries s
LEFT JOIN dept_emp d ON s.emp_no = d.emp_no 
WHERE s.to_date = '9999-01-01'
  AND d.to_date = '9999-01-01'
GROUP BY d.dept_no;
</code></pre>
<p><strong>扩展：</strong> 如果某部门薪水最大的员工有多人怎么办？ </p>
<p>STEP1：利用子查询首先创建两张表，一张为<code>MAXsalary</code>，用于存放当前每个部门薪水的最大值；另一张为<code>currentsalary</code>，用于存放当前每个部门所有员工的编号和薪水； </p>
<p>STEP2：限定条件为两张表的 <code>dept_no</code> 和 <code>salary</code> 相等，这样就可以找出当前每个部门所有薪水等于最大值的员工的相关信息； </p>
<p>STEP3：以下代码虽然稍长，仔细一看都是基于上面的基础解法变化而来的，中心思想就是绕开 <code>MAX()</code> 的特性限制，运用比较的方法选出多个相同的最大值。 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT currentsalary.dept_no,
       currentsalary.emp_no,
       currentsalary.salary AS salary
FROM 
-- 创建MAXsalary表用于存放当前每个部门薪水的最大值
    (
    SELECT d.dept_no, MAX(s.salary) AS salary
    FROM salaries AS s 
    INNER JOIN dept_emp As d
    ON d.emp_no = s.emp_no 
    WHERE d.to_date = '9999-01-01' 
      AND s.to_date = '9999-01-01'
    GROUP BY d.dept_no
    ) AS MAXsalary, 
-- 创建currentsalary表用于存放当前每个部门所有员工的编号和薪水
    (
    SELECT d.dept_no, s.emp_no, s.salary 
    FROM salaries AS s INNER JOIN dept_emp As d
    ON d.emp_no = s.emp_no 
    WHERE d.to_date = '9999-01-01' 
      AND s.to_date = '9999-01-01'
    ) AS currentsalary
-- 限定条件为两表的dept_no和salary均相等
WHERE currentsalary.dept_no = MAXsalary.dept_no
  AND currentsalary.salary = MAXsalary.salary
</code></pre>
<h3 id="12-职称的数目"><a href="#12-职称的数目" class="headerlink" title="12 职称的数目"></a>12 职称的数目</h3><p><strong>题目描述</strong>：从<code>titles</code>表获取按照<code>title</code>进行分组，找到每组个数大于等于2的<code>title</code>，给出<code>title</code>以及对应的数目<code>t</code> </p>
<p><strong>解题思路</strong>：</p>
<p>使用<code>GROUP BY</code>将<code>title</code>分组，再用<code>HAVING</code>子句找出大于等于2的组，<code>HAVING</code>必须在<code>GROUP BY</code>之后，并且有<code>GROUP BY</code>才能使用<code>HAVING</code>，聚合参数也可以是<code>COUNT(*)</code> 和<code>COUNT(emp_no)</code> ，还要注意 &gt;= 号之间不能有空格，否则会出错。 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT title,COUNT(*) 
FROM titles 
GROUP BY title 
HAVING COUNT(*) >= 2
</code></pre>
<p><strong>拓展：</strong> 员工在不同阶段，可能担任了相同的职务，因此在每个<code>title</code>下，<code>emp_no</code>重复的员工需要忽略不计。要对这种情况如何查询？</p>
<p><strong>解题思路</strong>：</p>
<p> 先用<code>GROUP BY</code>将表格以<code>title</code>分组，再用<code>COUNT(DISTINCT emp_no)</code>可以统计同一<code>title</code>值且不包含重复<code>emp_no</code>值的记录条数 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT title, COUNT(DISTINCT emp_no) AS t 
FROM titles
GROUP BY title 
HAVING t >= 2
</code></pre>
<h3 id="13-特定的员工信息"><a href="#13-特定的员工信息" class="headerlink" title="13 特定的员工信息"></a>13 特定的员工信息</h3><p><strong>题目描述</strong>：查找<code>employees</code>表所有<code>emp_no</code>为奇数，且<code>last_name</code>不为Mary的员工信息，并按照<code>hire_date</code>逆序排列</p>
<p><strong>解题思路</strong>：</p>
<p> 员工号为奇数，则<code>emp_no</code><strong>取余应为1</strong>，<code>last_name</code>不为Mary，用<code>!=</code>表示，另外注意字符串要用单括号括起来，逆序用<code>DESC</code>。 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT * 
FROM employees 
WHERE emp_no % 2 = 1
  AND last_name != 'Mary'
ORDER BY hire_date DESC;
</code></pre>
<h3 id="14-职称的平均工资"><a href="#14-职称的平均工资" class="headerlink" title="14 职称的平均工资"></a>14 职称的平均工资</h3><p><strong>题目描述</strong>： 统计出当前各个<code>title</code>类型对应的员工当前<em>(to_date=’9999-01-01’)</em>薪水对应的平均工资。结果给出<code>title</code>以及平均工资。</p>
<p><strong>解题思路</strong>：</p>
<p>使用<code>GROUP BY</code> 对<code>title</code>进行分组，当前用两表<em>to_date=’9999-01-01’</em>进行限定，平均工资用聚合函数avg。 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT t.title,avg(salary) AS avg
FROM salaries s
INNER JOIN titles t ON s.emp_no = t.emp_no 
WHERE s.to_date = '9999-01-01'
  AND t.to_date = '9999-01-01'
GROUP BY t.title;
</code></pre>
<h3 id="15-薪水第二多的员工信息"><a href="#15-薪水第二多的员工信息" class="headerlink" title="15 薪水第二多的员工信息"></a>15 薪水第二多的员工信息</h3><p><strong>题目描述</strong>：获取当前<em>(to_date=’9999-01-01’)</em>薪水第二多的员工的<code>emp_no</code>以及其对应的薪水<code>salary</code></p>
<p><strong>解题思路</strong>：</p>
<p>STEP1：先在工资表里找出最多工资，再以工资小于最大工资为限定条件，即<code>salary &lt; (SELECT MAX(salary)</code>可以得到排名第二的工资。</p>
<p>STEP2：再使用<code>MAX(salary)</code>在除去排名第一工资的表里找最大的工资，即找到排名第二的工资。</p>
<p>STEP3：使用这种这个查询方法，不管工资第一多的员工有多少个都能查到工资第二多的员工，且当工资第二多的员工有多个时也都能查询出来。</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT emp_no, salary 
FROM salaries 
WHERE salary = 
    (
    SELECT MAX(salary) 
    FROM salaries 
    WHERE to_date = '9999-01-01' 
        AND salary < 
            (
            SELECT MAX(salary) 
            FROM salaries 
            WHERE to_date = '9999-01-01' 
            ) 
    );
</code></pre>
<p>更简单一点的写法，使用<code>DISTINCT</code>和<code>LIMIT</code></p>
<pre class=" language-mysql"><code class="language-mysql">SELECT emp_no,salary 
FROM salaries
WHERE to_date = '9999-01-01'  
  AND salary = (
                  SELECT DISTINCT salary 
                FROM salaries 
                  WHERE to_date = '9999-01-01' 
                ORDER BY salary DESC 
                LIMIT 1,1
                  )
</code></pre>
<h3 id="16-薪水第二多的员工信息-禁用排序"><a href="#16-薪水第二多的员工信息-禁用排序" class="headerlink" title="16 薪水第二多的员工信息(禁用排序)"></a>16 薪水第二多的员工信息(禁用排序)</h3><p><strong>题目描述</strong>：查找当前薪水<em>(to_date=’9999-01-01’)</em>排名第二多的员工编号<code>emp_no</code>、薪水<code>salary</code>、<code>last_name</code>以及<code>first_name</code>，不准使用<code>ORDER BY</code> </p>
<p><strong>解题思路</strong>：</p>
<p>本题只需要在上一题的基础上增加一个内联结(左联结)即可将薪水<code>salary</code>、<code>last_name</code>以及<code>first_name</code>查询出来。 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT e.emp_no,s.salary,e.last_name,e.first_name 
FROM employees e
INNER JOIN salaries s ON e.emp_no = s.emp_no 
WHERE
  salary = 
  (
    SELECT MAX(salary) 
    FROM salaries 
    WHERE to_date = '9999-01-01' 
        AND salary < 
            (
            SELECT MAX(salary) 
            FROM salaries 
            WHERE to_date = '9999-01-01'
            ) 
    );
</code></pre>
<p><strong>拓展</strong>：如果将第二高改为第三高，第四高呢？使用<code>MAX</code>函数嵌套的方式过于低效，能否写一种通用的方式来获取第N高的员工信息？</p>
<p><strong>解题思路</strong>：薪水第二多的意思就是只有一个人比他多，这样只要用<code>salary</code>表自连接，再分组，分组条件为<code>s1.salary &lt; s2.salary</code>。组内条数等于1的那条记录，就正好是第二多。如果要找第三多，那就让<code>HAVING COUNT(*)=1</code>就可以了如果有两个人比那个人多，这两个人的薪水值相同的话，还要用一下<code>DISTINCT</code>关键字去重。</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT e.emp_no,s.salary,e.last_name,e.first_name
FROM employees e
JOIN salaries s ON e.emp_no=s.emp_no 
    AND s.to_date='9999-01-01'
    AND s.salary = 
        (
         SELECT s1.salary
         FROM salaries s1
         JOIN salaries s2 ON s1.salary < s2.salary 
         WHERE s1.to_date='9999-01-01' 
           AND s2.to_date='9999-01-01'
         GROUP BY s1.salary
         HAVING COUNT(DISTINCT s2.salary) = 1-- 这里写第几高
         )
</code></pre>
<h3 id="17-员工对应的部门"><a href="#17-员工对应的部门" class="headerlink" title="17 员工对应的部门"></a>17 员工对应的部门</h3><p><strong>题目描述</strong>：查找所有员工的<code>last_name</code>和<code>first_name</code>以及对应的<code>dept_name</code>，也包括暂时没有分配部门的员工</p>
<p><strong>解题思路</strong>：</p>
<p>本题关键在于理清三表之间关联关系。需要使用两次左联结。:</p>
<p>STEP1：题目要求包括暂时没有分配部门的员工，所以将<code>employees</code>作为主表，使用左联结将其和<code>dept_emp</code>表联结，联结条件为员工编号<code>emp_no</code>，得出所有员工所在部门，并将结果命名为<code>a</code>。</p>
<p>STEP2：将查询结果<code>a</code>与<code>departments</code>左联结，联结条件为部门编号<code>dept_no</code>，求出部门名字<code>dept_name</code>。</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT last_name, first_name, dept_name 
FROM
  (
    SELECT e.last_name, e.first_name, de.dept_no 
    FROM employees e
    LEFT JOIN dept_emp de ON e.emp_no = de.emp_no 
  ) a
LEFT JOIN departments dp ON a.dept_no = dp.dept_no;
</code></pre>
<h3 id="18-薪水涨幅"><a href="#18-薪水涨幅" class="headerlink" title="18 薪水涨幅"></a>18 薪水涨幅</h3><p><strong>题目描述</strong>：查找员工编号<code>emp_no</code>为10001其自入职以来的薪水<code>salary</code>涨幅值<code>growth</code></p>
<p><strong>解题思路</strong>：</p>
<p> 对“入职以来的薪水salary涨幅值growth”有两种理解：</p>
<ul>
<li><p>员工入职以来工资最大值减去工资最小值。</p>
</li>
<li><p>最新一次工资减去入职时的工资，即为涨幅值<code>growth</code>，此种方式更严谨。 </p>
</li>
</ul>
<pre class=" language-mysql"><code class="language-mysql">-- 方法一
SELECT MAX(salary) - min(salary) AS growth 
FROM salaries 
WHERE emp_no = '10001';
-- 方法二
SELECT
(
 SELECT salary 
 FROM salaries 
 WHERE emp_no = '10001' 
 ORDER BY to_date DESC 
 LIMIT 1 
) 
- 
( 
 SELECT salary 
 FROM salaries 
 WHERE emp_no = '10001' 
 ORDER BY to_date ASC 
 LIMIT 1 
) AS growth;

FROM salaries;
</code></pre>
<h3 id="19-所有员工的薪水涨幅"><a href="#19-所有员工的薪水涨幅" class="headerlink" title="19 所有员工的薪水涨幅"></a>19 所有员工的薪水涨幅</h3><p><strong>题目描述</strong>：查找所有员工自入职以来的薪水涨幅情况，给出员工编号<code>emp_no</code>以及其对应的薪水涨幅<code>growth</code>，并按照<code>growth</code>进行升序</p>
<p><strong>解题思路</strong>：</p>
<p>STEP1： 先创建两个子查询，分别找出所有员工当前的薪水(子查询a)和所有员工入职时的薪水(如子查询b) </p>
<p>STEP2： a，b子查询运用的方法都是一样的，联结<code>employees</code>表和<code>salaries</code>表，左联结内联结都可以，子查询a限定条件直接为当前时间’9999-01-01’，子查询b限定条件为入职时间，每个员工入职时间不一样，所以要使用谓词 <code>in</code> 找出在工资表里所有员工对应的最小时间。最后a，b子查询都要对员工编号进行分组。 </p>
<p>STEP3： 最后将这两个子查询联结，联结条件为<code>a.emp_no = b.emp_no</code>，再按照题目要求对薪水涨幅进行升序排序。 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT
  a.emp_no,
  (a.salary - b.salary) AS growth
FROM
  (
    SELECT e.emp_no,s.salary
    FROM employees e
    LEFT JOIN salaries s ON e.emp_no = s.emp_no
    WHERE s.to_date = '9999-01-01'
    GROUP BY s.emp_no
  ) a,
  (
    SELECT e.emp_no,s.salary
    FROM employees e
    LEFT JOIN salaries s ON e.emp_no = s.emp_no
    WHERE s.to_date IN 
    (
        SELECT min(to_date)
        FROM salaries s
        GROUP BY s.emp_no
    )
    GROUP BY s.emp_no
  ) b
WHERE a.emp_no = b.emp_no
ORDER BY growth ASC;
</code></pre>
<h3 id="20-各部门的工资记录"><a href="#20-各部门的工资记录" class="headerlink" title="20 各部门的工资记录"></a>20 各部门的工资记录</h3><p><strong>题目描述</strong>：统计各个部门的工资记录数，给出部门编码<code>dept_no</code>、部门名称<code>dept_name</code>以及次数SUM</p>
<p><strong>解题思路</strong>：</p>
<p> <code>将departments</code>和<code>dept_emp</code>联结(左联结内联结都可以)，得到员工对应的部门编号和部门名称后，再联结<code>salaries</code>表，通过对部门分组，得到每组工资数。 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT a.dept_no, a.dept_name, COUNT(*) AS SUM
FROM
  (
    SELECT d.dept_no,de.emp_no,d.dept_name
    FROM dept_emp de
    LEFT JOIN departments d ON de.dept_no = d.dept_no
  ) a
INNER JOIN salaries s ON a.emp_no = s.emp_no
GROUP BY a.dept_no;
</code></pre>
<h3 id="21-工资排名"><a href="#21-工资排名" class="headerlink" title="21 工资排名"></a>21 工资排名</h3><p><strong>题目描述</strong>：对所有员工的当前<em>(to_date=’9999-01-01’)</em>薪水按照<code>salary</code>进行按照1-N的排名，相同<code>salary</code>并列且按照<code>emp_no</code>升序排列</p>
<p><strong>解题思路</strong>：</p>
<p> 经典的排名问题。解决方式分为两种，一种使用开窗函数，另一种不使用。</p>
<p><strong>开窗函数版本：</strong></p>
<p>使用窗口函数<code>DENSE_RANK() OVER()</code>函数即可将实现薪水按照<code>salary</code>进行按照1-N的排名，相同<code>salary</code>并列。这里需要注意的是开窗函数在各种SQL查询引擎中都有广泛的使用，但是<strong>MySQL8.0以上的版本才支持开窗函数</strong></p>
<blockquote>
<p>窗口函数：&lt;窗口函数&gt; OVER ([PARITITION BY &lt;列清单&gt;] ORDER BY &lt;排序用列清单&gt;) [PARITITION BY &lt;列清单&gt;]可以省略。</p>
</blockquote>
<p>在开窗函数中，有3个与排序相关的函数，分别问<code>RANK()、DENSE_RANK()、ROW_NUMBER()</code>：</p>
<ul>
<li><p><code>RANK() OVER (ORDER BY &lt;列名&gt;)</code>：计算排序，如果存在相同位次的记录，则会跳过之后的位次。如1,1,1,4</p>
</li>
<li><p><code>DENSE_RANK () OVER (ORDER BY &lt;列名&gt;)</code>：计算排序，即使存在相同位次的记录，也不会跳过之后的位次。如1,1,1,2</p>
</li>
<li><p><code>ROW_NUMBER () OVER (ORDER BY &lt;列名&gt;)</code>：计算排序，赋予唯一的连续位次。如：1,2,3,4</p>
</li>
</ul>
<pre class=" language-mysql"><code class="language-mysql">SELECT emp_no,salary,
       dense_rank() over (ORDER BY salary DESC) AS 'rank'
FROM salaries
WHERE to_date = '9999-01-01'
ORDER BY salary DESC,emp_no ASC;
</code></pre>
<p><strong>普通版本：</strong></p>
<p>SETP1：利用自联结，复用两张<code>salaries</code>进行比较排名，联结两表条件为to_date = ‘9999-01-01’。</p>
<p>SETP2：此外重点在于限定条件<code>s1.salary &lt;= s2.salary</code>，在输出s1.salary的情况下，有多少个s2.salary大于等于s1.salary，即计数<code>COUNT(DISTINCT s2.salary)</code>，并以计数结果作为排序结果。</p>
<p>SETP3：由于两表联结，同样 <code>salary</code> 算作一样的排名，所以需要去重处理<code>COUNT(DISTINCT s2.salary)</code>。</p>
<p>SETP4：因为使用了合计函数，<code>COUNT</code>只返回一个值，所以必须进行分组查询，最后使用<code>ORDER BY</code>排序。</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT s1.emp_no,s1.salary,COUNT(DISTINCT s2.salary) AS 'rank'
FROM salaries AS s1
INNER JOIN salaries AS s2 ON s1.to_date = '9999-01-01'
  AND s2.to_date = '9999-01-01'
WHERE s1.salary <= s2.salary
GROUP BY s1.emp_no
ORDER BY s1.salary DESC,s1.emp_no ASC
</code></pre>
<h3 id="22-普通员工的薪水"><a href="#22-普通员工的薪水" class="headerlink" title="22 普通员工的薪水"></a>22 普通员工的薪水</h3><p><strong>题目描述</strong>：获取所有非<code>manager</code>员工当前的薪水情况，给出<code>dept_no</code>、<code>emp_no</code>以及<code>salary</code> ，当前表示<em>to_date=’9999-01-01’</em></p>
<p><strong>解题思路</strong>：</p>
<p>先联结员工表和工资表找出所有人的员工编号和工资，再联结部门员工表找出所有员工的编号，最后使用<code>not in</code>找出非<code>manager</code> 的员工。最后记得限定工资表salaries和员工表<code>dept_emp</code>的时间都为<em>to_date=’9999-01-01’</em>。</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT de.dept_no,e.emp_no,s.salary
FROM employees e
INNER JOIN salaries s ON e.emp_no = s.emp_no
AND s.to_date = '9999-01-01'
INNER JOIN dept_emp de ON e.emp_no = de.emp_no
WHERE de.to_date = '9999-01-01'
  AND de.emp_no NOT IN (
                        SELECT emp_no FROM dept_manager
                        );
</code></pre>
<h3 id="23-比领导薪水还高的员工"><a href="#23-比领导薪水还高的员工" class="headerlink" title="23 比领导薪水还高的员工"></a>23 比领导薪水还高的员工</h3><p><strong>题目描述</strong>：获取员工其当前的薪水比其<code>manager</code>当前薪水还高的相关信息，当前表示<em>to_date=’9999-01-01’</em>，查询出 员工的<code>emp_no</code>， 其<code>manager</code>的<code>manager_no</code>， 该员工当前的薪水<code>emp_salary</code>，该员工对应的<code>manager</code>当前的薪水<code>manager_salary</code></p>
<p><strong>解题思路</strong>：</p>
<p> 将题目分解为三部分，做好链接即可：</p>
<ul>
<li>显示员工以及其<code>Manager</code></li>
<li>显示员工的薪水以及<code>Manager</code>的薪水</li>
<li>筛选员工薪酬比<code>Manager</code>高的部分人员，包括经理自己 </li>
</ul>
<pre class=" language-mysql"><code class="language-mysql">SELECT de.emp_no,dm.emp_no manager_no,
      sa.salary emp_salary,sal.salary manager_salary
FROM dept_emp de,salaries sa,dept_manager dm,salaries sal
WHERE de.emp_no=sa.emp_no
  AND dm.emp_no=sal.emp_no
  AND de.dept_no=dm.dept_no
  AND de.to_date='9999-01-01'
  AND sa.to_date='9999-01-01'
  AND dm.to_date='9999-01-01'
  AND sal.to_date='9999-01-01'
  AND sa.salary>sal.salary
</code></pre>
<h3 id="24-各部门的职称数量"><a href="#24-各部门的职称数量" class="headerlink" title="24 各部门的职称数量"></a>24 各部门的职称数量</h3><p><strong>题目描述</strong>：汇总各个部门当前员工的<code>title</code>类型的分配数目，结果给出部门编号<code>dept_no</code>、<code>dept_name</code>、其当前员工所有的<code>title</code>以及该类型title对应的数目<code>COUNT</code></p>
<p><strong>解题思路</strong>：</p>
<p> 重点理解各个部门下各个<code>title</code>类型的汇总。</p>
<p>先以员工编号为联结条件联结<code>titles</code>表和<code>dept_emp</code>表，得到员工部门编号和员工对应的<code>title</code>类型，再以部门编号为联结条件联结<code>departments</code>表，得到部门名称，最后记得限定<code>titles</code>表和<code>dept_emp</code>表的时间为当前<em>to_date =’9999-01-01’</em>。汇总的是各个部门下各个<code>title</code>类型，所以要先将部门编号进行一次汇总，再将<code>tltle</code>类型进行汇总，聚合函数<code>COUNT</code>的参数为<code>title</code>。</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT de.dept_no,dp.dept_name,
       t.title,COUNT(t.title) AS COUNT
FROM titles t
LEFT JOIN dept_emp de ON t.emp_no = de.emp_no
  AND t.to_date = '9999-01-01'
  AND de.to_date = '9999-01-01'
INNER JOIN departments dp ON de.dept_no = dp.dept_no
GROUP BY de.dept_no, t.title
</code></pre>
<h3 id="25-查看姓名"><a href="#25-查看姓名" class="headerlink" title="25 查看姓名"></a>25 查看姓名</h3><p><strong>题目描述</strong>： 将<code>employees</code>表中的所有员工的<code>last_name</code>和<code>first_name</code>通过(<code>-</code>)连接起来。</p>
<p><strong>解题思路</strong>：</p>
<p> 考察字符串拼接函数<code>CONCAT(&lt;列1&gt;,&lt;列2&gt;…)</code>，多个列或字符串之间用个逗号隔开，这里last_name和first_name通过(<code>-</code>)连接，符号<code>-</code>要用双引号括起来。 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT CONCAT(last_name,"-",first_name) AS name
FROM employees;
</code></pre>
<h3 id="26-查看字符出现的次数"><a href="#26-查看字符出现的次数" class="headerlink" title="26 查看字符出现的次数"></a>26 查看字符出现的次数</h3><p><strong>题目描述</strong>：  查找字符串<code>&#39;10,A,B&#39;</code> 中逗号<code>&#39;,&#39;</code>出现的次数<code>cnt</code></p>
<p><strong>解题思路</strong>：</p>
<p>STEP1：巧用<code>length</code>函数和<code>replace</code>，<code>length</code>函数计算字符串的长度，<code>length(&quot;10,A,B&quot;)</code>算出整个字符串的长度。</p>
<p>STEP2：使用<code>replace</code>将 ,逗号替换为空，那么整个字符串减少的长度等于逗号的长度，两者相减就是 , 出现的次数。</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT (length("10,A,B") - length(replace("10,A,B", ",", ""))) as cnt;
</code></pre>
<h3 id="27-平均工资-排除最大与最小值"><a href="#27-平均工资-排除最大与最小值" class="headerlink" title="27 平均工资(排除最大与最小值)"></a>27 平均工资(排除最大与最小值)</h3><p><strong>题目描述</strong>：   查找排除当前最大、最小<code>salary</code>之后的员工的平均工资 </p>
<p><strong>解题思路</strong>：</p>
<p> 用两个子查询找出最大工资和最小工资，再用<code>not in</code>去除最大工资和最小工资，最后记得限定时间为当前。</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT AVG(salary) AS avg_salary
FROM salaries
WHERE salary NOT IN
    (SELECT MAX(salary) FROM salaries WHERE to_date = '9999-01-01')
AND salary NOT IN
    (SELECT MAX(salary) FROM salaries WHERE to_date = '9999-01-01')
AND to_date = '9999-01-01';
</code></pre>
<h3 id="28-员工的奖金"><a href="#28-员工的奖金" class="headerlink" title="28 员工的奖金"></a>28 员工的奖金</h3><p><strong>题目描述</strong>：  获取有奖金的员工相关信息，查询出<code>emp_no</code>、<code>first_name</code>、<code>last_name</code>、奖金类型<code>btype</code>、对应的当前薪水情况<code>salary</code>以及奖金金额<code>bonus</code>。</p>
<p><code>bonus</code>类型<code>btype</code>为<code>1</code>则其奖金为薪水<code>salary</code>的<code>10%</code>，<code>btype</code>为<code>2</code>其奖金为薪水的<code>20%</code>，其他类型均为薪水的<code>30%</code>。当前薪水表示*to_date=’9999-01-01’ *</p>
<p><strong>解题思路</strong>：</p>
<p>STEP1：使用<code>CASE WHEN</code>表达式对奖金进行行列转换，这里使用的是<code>CASE WHEN &lt;列名&gt; then …</code>的搜索<code>case</code>表达式，最后要记得使用<code>end</code>结束case，并将结果重命名为BONUS。</p>
<p>STEP2：使用员工编号为限定条件将三表联结查询，还有限定时间为当前。</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT eb.emp_no,e.first_name,
       e.last_name,eb.btype,s.salary,
       (CASE WHEN eb.btype = 1 then s.salary * 0.1
             when eb.btype = 2 then s.salary * 0.2
             else s.salary * 0.3 end
       ) as bonus

FROM salaries s,emp_bonus eb,employees e
WHERE eb.emp_no = s.emp_no
 AND eb.emp_no = e.emp_no
 AND s.to_date = '9999-01-01';
</code></pre>
<h3 id="29-薪水的累计"><a href="#29-薪水的累计" class="headerlink" title="29 薪水的累计"></a>29 薪水的累计</h3><p><strong>题目描述</strong>：按照<code>salary</code>的累计和<code>running_total</code>，其中<code>running_total</code>为前两个员工的<code>salary</code>累计和，其他以此类推。 具体结果如下表展示。 </p>
<table>
<thead>
<tr>
<th align="left">emp_no</th>
<th align="left">salary</th>
<th align="left">running_total</th>
</tr>
</thead>
<tbody><tr>
<td align="left">10001</td>
<td align="left">88958</td>
<td align="left">88958</td>
</tr>
<tr>
<td align="left">10002</td>
<td align="left">72527</td>
<td align="left">161485</td>
</tr>
<tr>
<td align="left">10003</td>
<td align="left">43311</td>
<td align="left">204796</td>
</tr>
<tr>
<td align="left">10004</td>
<td align="left">74057</td>
<td align="left">278853</td>
</tr>
<tr>
<td align="left">10005</td>
<td align="left">94692</td>
<td align="left">373545</td>
</tr>
<tr>
<td align="left">10006</td>
<td align="left">43311</td>
<td align="left">416856</td>
</tr>
<tr>
<td align="left">10007</td>
<td align="left">88070</td>
<td align="left">504926</td>
</tr>
<tr>
<td align="left">10009</td>
<td align="left">95409</td>
<td align="left">600335</td>
</tr>
<tr>
<td align="left">10010</td>
<td align="left">94409</td>
<td align="left">694744</td>
</tr>
<tr>
<td align="left">10011</td>
<td align="left">25828</td>
<td align="left">720572</td>
</tr>
</tbody></table>
<p><strong>窗口函数版本解题思路：</strong></p>
<p>STEP1：本题关键在于把<code>SUM</code>聚合函数作为窗口函数使用，所有聚合函数都能用做窗口函数，其语法和专用窗口函数完全相同。</p>
<p><code>SUM(&lt;汇总列&gt;) over(&lt;排序列&gt;) as 别名</code>；</p>
<p>STEP2：光看题目“前两个员工的<code>salary</code>累计和”不是很好理解，结合输出格式可以理解为<code>running_total</code>列是逐个员工的工资的累计和，每一行的工资都是前面所有行的工资总计。</p>
<p>STEP3：这有一个小bug，题目没有限定时间为当前，而按照输出格式来看和通过情况来看，只有限定时间为当前’9999-01-01’才能符合输出格式，才能通过，一开始考虑用员工分组，但是员工分组得到的结果并非题目本意，必须限定时间为当前。</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT emp_no,salary,
sum(salary) over(ORDER BY emp_no) as running_total
FROM salaries
WHERE to_date= '9999-01-01';
</code></pre>
<p><strong>普通查询版本解题思路：</strong></p>
<p>利用复表查询，以及<code>running_total</code>等于逐个员工的工资的累计和，即找出在表2中小于等于表1员工编号的所有员工工资进行求和，最后记得限定时间为当前，且要按照<code>emp_no</code>升序排序。</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT s1.emp_no, s1.salary,
(SELECT sum(s2.salary) 
 FROM salaries s2
 WHERE s2.emp_no <= s1.emp_no 
   AND s2.to_date = '9999-01-01'
) as running_total
FROM salaries s1 
WHERE s1.to_date = '9999-01-01' 
ORDER BY s1.emp_no;
</code></pre>
<h3 id="30-奇数行的员工姓名"><a href="#30-奇数行的员工姓名" class="headerlink" title="30 奇数行的员工姓名"></a>30 奇数行的员工姓名</h3><p><strong>题目描述</strong>：对于<code>employees</code>表中，给出奇数行的<code>first_name</code> </p>
<p><strong>解题思路</strong>：</p>
<p> STEP1：窗口函数<code>row_number</code>的作用是赋予唯一的连续位次。巧用窗口函数<code>row_number</code>对数据进行行排序，对<code>first_name</code>进行排序，将得到的位次命名为row_num。</p>
<p>STEP2：用求余函数找出奇数行。 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT a.first_name
FROM (SELECT emp_no, first_name, 
             row_number() over(ORDER BY first_name) as row_num
      FROM employees) a
WHERE row_num % 2 = 1
ORDER BY emp_no;
</code></pre>
<h2 id="五、进阶题目"><a href="#五、进阶题目" class="headerlink" title="五、进阶题目"></a>五、进阶题目</h2><p>本节题目只提供表结构且有一定难度,其中部分题目与四中类似，做不出来的小伙伴也不要灰心呦。可以先写下自己的思考过程再对照答案，会更有收获。</p>
<h3 id="1、连续出现的数字-查连续出现N次的数据"><a href="#1、连续出现的数字-查连续出现N次的数据" class="headerlink" title="1、连续出现的数字(查连续出现N次的数据)"></a>1、连续出现的数字(查连续出现N次的数据)</h3><h4 id="1-1、题目描述"><a href="#1-1、题目描述" class="headerlink" title="1.1、题目描述"></a>1.1、题目描述</h4><p>编写一个 SQL 查询，查找所有至少连续出现三次的数字。</p>
<table>
<thead>
<tr>
<th>Id</th>
<th>Num</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>4</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>1</td>
</tr>
<tr>
<td>6</td>
<td>2</td>
</tr>
<tr>
<td>7</td>
<td>2</td>
</tr>
</tbody></table>
<p>例如，给定上面的 <code>Logs</code> 表， <code>1</code>是唯一连续出现至少三次的数字。</p>
<table>
<thead>
<tr>
<th>ConsecutiveNums</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
</tr>
</tbody></table>
<h4 id="1-2、解题方法"><a href="#1-2、解题方法" class="headerlink" title="1.2、解题方法"></a>1.2、解题方法</h4><p> 连续出现的意味着相同数字的 Id 是连着的，由于这题问的是至少连续出现 3 次，我们使用 <code>Logs</code>并检查是否有 3 个连续的相同数字。 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT *
FROM
    Logs l1,
    Logs l2,
    Logs l3
WHERE
    l1.Id = l2.Id - 1
    AND l2.Id = l3.Id - 1
    AND l1.Num = l2.Num
    AND l2.Num = l3.Num
;
</code></pre>
<table>
<thead>
<tr>
<th>Id</th>
<th>Num</th>
<th>Id</th>
<th>Num</th>
<th>Id</th>
<th>Num</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>3</td>
<td>1</td>
</tr>
</tbody></table>
<p> 注意：前两列来自 l1 ，接下来两列来自 l2 ，最后两列来自 l3 。 </p>
<pre class=" language-mysql"><code class="language-mysql">SELECT DISTINCT
    l1.Num AS ConsecutiveNums
FROM
    Logs l1,
    Logs l2,
    Logs l3
WHERE
    l1.Id = l2.Id - 1
    AND l2.Id = l3.Id - 1
    AND l1.Num = l2.Num
    AND l2.Num = l3.Num
</code></pre>
<p><strong>思考一下，如果是将连续重复的数字的整条记录查询出来应该怎么做呢？</strong></p>
<h3 id="2、部门工资前三高的所有员工-分组求前N个"><a href="#2、部门工资前三高的所有员工-分组求前N个" class="headerlink" title="2、部门工资前三高的所有员工(分组求前N个)"></a>2、部门工资前三高的所有员工(分组求前N个)</h3><h4 id="2-1、题目描述"><a href="#2-1、题目描述" class="headerlink" title="2.1、题目描述"></a>2.1、题目描述</h4><p><code>Employee</code> 表包含所有员工信息，每个员工有其对应的工号 <code>Id</code>，姓名 <code>Name</code>，工资 <code>Salary</code> 和部门编号 <code>DepartmentId</code> 。</p>
<table>
<thead>
<tr>
<th>Id</th>
<th>Name</th>
<th>Salary</th>
<th>DepartmentId</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>Joe</td>
<td>85000</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>Henry</td>
<td>80000</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>Sam</td>
<td>60000</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>Max</td>
<td>90000</td>
<td>1</td>
</tr>
<tr>
<td>5</td>
<td>Janet</td>
<td>69000</td>
<td>1</td>
</tr>
<tr>
<td>6</td>
<td>Randy</td>
<td>85000</td>
<td>1</td>
</tr>
<tr>
<td>7</td>
<td>Will</td>
<td>70000</td>
<td>1</td>
</tr>
</tbody></table>
<p><code>Department</code> 表包含公司所有部门的信息。</p>
<table>
<thead>
<tr>
<th>Id</th>
<th>Name</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>IT</td>
</tr>
<tr>
<td>2</td>
<td>Sales</td>
</tr>
</tbody></table>
<p>编写一个 SQL 查询，找出每个部门获得前三高工资的所有员工。例如，根据上述给定的表，查询结果应返回：</p>
<table>
<thead>
<tr>
<th>Department</th>
<th>Employee</th>
<th>Salary</th>
</tr>
</thead>
<tbody><tr>
<td>IT</td>
<td>Max</td>
<td>90000</td>
</tr>
<tr>
<td>IT</td>
<td>Randy</td>
<td>85000</td>
</tr>
<tr>
<td>IT</td>
<td>Joe</td>
<td>85000</td>
</tr>
<tr>
<td>IT</td>
<td>Will</td>
<td>70000</td>
</tr>
<tr>
<td>Sales</td>
<td>Henry</td>
<td>80000</td>
</tr>
<tr>
<td>Sales</td>
<td>Sam</td>
<td>60000</td>
</tr>
</tbody></table>
<p>解释：</p>
<p>IT 部门中，Max 获得了最高的工资，RANDy 和 Joe 都拿到了第二高的工资，Will 的工资排第三。销售部门(Sales)只有两名员工，Henry 的工资最高，Sam 的工资排第二。</p>
<h4 id="2-2、解题方法"><a href="#2-2、解题方法" class="headerlink" title="2.2、解题方法"></a>2.2、解题方法</h4><p>1、我们先找出公司里前 3 高的薪水，意思是不超过三个值比这些值大</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT e1.Salary 
FROM Employee AS e1
WHERE 3 > 
        (SELECT COUNT(DISTINCT e2.Salary) 
         FROM    Employee AS e2 
          WHERE    e1.Salary < e2.Salary     AND e1.DepartmentId = e2.DepartmentId) ;
</code></pre>
<p>2、再把表 <code>Department</code> 和表 <code>Employee</code> 连接，获得各个部门工资前三高的员工。 </p>
<p>举例说明：<br>当 e1 = e2 = [50,100,150,200,250]</p>
<p>e1.Salary = 50，e2.Salary 可以取值 [100,150,200,250]，COUNT(DISTINCT e2.Salary) = 4</p>
<p>e1.Salary = 100，e2.Salary 可以取值 [150,200,250]，COUNT(DISTINCT e2.Salary) = 3</p>
<p>e1.Salary = 150，e2.Salary 可以取值 [200,250]，COUNT(DISTINCT e2.Salary) = 2</p>
<p>e1.Salary = 200，e2.Salary 可以取值 [250]，COUNT(DISTINCT e2.Salary) = 1</p>
<p>e1.Salary = 250，e2.Salary 可以取值 []，COUNT(DISTINCT e2.Salary) = 0</p>
<p>最后 3 &gt; COUNT(DISTINCT e2.Salary)，所以 e1.Salary 可取值为 [150,200,250]，即集合前 3 高的薪水</p>
<p>再把表 Department 和表 Employee 连接，获得各个部门工资前三高的员工。</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT
    Department.NAME AS Department,
    e1.NAME AS Employee,
    e1.Salary AS Salary 
FROM
    Employee AS e1,Department 
WHERE
    e1.DepartmentId = Department.Id 
    AND 3 > (SELECT  COUNT( DISTINCT e2.Salary ) 
             FROM    Employee AS e2 
             WHERE    e1.Salary < e2.Salary     AND e1.DepartmentId = e2.DepartmentId     ) 
ORDER BY Department.NAME,Salary DESC;
</code></pre>
<h3 id="3、汇总成绩"><a href="#3、汇总成绩" class="headerlink" title="3、汇总成绩"></a>3、汇总成绩</h3><h4 id="3-1、题目描述"><a href="#3-1、题目描述" class="headerlink" title="3.1、题目描述"></a>3.1、题目描述</h4><p>已知<code>score</code>表结构为下方所示:</p>
<table>
<thead>
<tr>
<th>name</th>
<th>subject</th>
<th>score</th>
</tr>
</thead>
<tbody><tr>
<td>张三</td>
<td>语文</td>
<td>80</td>
</tr>
<tr>
<td>李四</td>
<td>语文</td>
<td>90</td>
</tr>
<tr>
<td>张三</td>
<td>数学</td>
<td>80</td>
</tr>
<tr>
<td>李四</td>
<td>数学</td>
<td>70</td>
</tr>
<tr>
<td>张三</td>
<td>英语</td>
<td>90</td>
</tr>
<tr>
<td>李四</td>
<td>英语</td>
<td>50</td>
</tr>
</tbody></table>
<p>要求查询结果为：</p>
<table>
<thead>
<tr>
<th>name</th>
<th>chinese</th>
<th>math</th>
<th>english</th>
<th>score</th>
</tr>
</thead>
<tbody><tr>
<td>张三</td>
<td>80</td>
<td>80</td>
<td>90</td>
<td>250</td>
</tr>
<tr>
<td>李四</td>
<td>90</td>
<td>70</td>
<td>50</td>
<td>210</td>
</tr>
</tbody></table>
<h4 id="3-2、解题方法"><a href="#3-2、解题方法" class="headerlink" title="3.2、解题方法"></a>3.2、解题方法</h4><ol>
<li>SUM-CASE方法</li>
</ol>
<pre class=" language-mysql"><code class="language-mysql">SELECT name
    ,SUM(CASE subject WHEN '语文' THEN score ELSE 0 END) AS chinese
    ,SUM(CASE subject WHEN '数学' THEN score ELSE 0 end) as math
    ,SUM(CASE subject WHEN '英语' THEN score ELSE 0 end) as english
    ,SUM(socre)as score
  FROM score GROUP BY name
</code></pre>
<ol start="2">
<li>IF方法</li>
</ol>
<pre class=" language-mysql"><code class="language-mysql">SELECT name ,
    sum(if(subject='语文',score,0)) as chinese,
    sum(if(subject='数学',score,0))as math, 
    sum(if(subject='英语',score,0))as english,
    SUM(score) as 总分
FROM score GROUP BY name     
</code></pre>
<h3 id="4、换座位"><a href="#4、换座位" class="headerlink" title="4、换座位"></a>4、换座位</h3><h4 id="4-1、题目描述"><a href="#4-1、题目描述" class="headerlink" title="4.1、题目描述"></a>4.1、题目描述</h4><p>小美是一所中学的信息科技老师，她有一张 <code>seat</code> 座位表，平时用来储存学生名字和与他们相对应的座位 id。</p>
<p>其中纵列的 <code>id</code> 是连续递增的</p>
<p>小美想改变相邻俩学生的座位。</p>
<p>你能不能帮她写一个 SQL query 来输出小美想要的结果呢？</p>
<p> 示例：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>student</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>Abbot</td>
</tr>
<tr>
<td>2</td>
<td>Doris</td>
</tr>
<tr>
<td>3</td>
<td>Emerson</td>
</tr>
<tr>
<td>4</td>
<td>Green</td>
</tr>
<tr>
<td>5</td>
<td>Jeames</td>
</tr>
</tbody></table>
<p>假如数据输入的是上表，则输出结果如下：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>student</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>Doris</td>
</tr>
<tr>
<td>2</td>
<td>Abbot</td>
</tr>
<tr>
<td>3</td>
<td>Green</td>
</tr>
<tr>
<td>4</td>
<td>Emerson</td>
</tr>
<tr>
<td>5</td>
<td>Jeames</td>
</tr>
</tbody></table>
<blockquote>
<p>注意：如果学生人数是奇数，则不需要改变最后一个同学的座位。</p>
<p>题目来源：<a href="https://leetcode-cn.com/problems/exchange-seats" target="_blank" rel="noopener">力扣(LeetCode)</a></p>
</blockquote>
<h4 id="4-2、解题方法"><a href="#4-2、解题方法" class="headerlink" title="4.2、解题方法"></a>4.2、解题方法</h4><ol>
<li>case关键字解法(最容易理解)</li>
</ol>
<pre class=" language-mysql"><code class="language-mysql">SELECT (CASE
WHEN MOD(id,2) = 1 AND id = (SELECT COUNT(*) FROM seat) THEN id
WHEN MOD(id,2) = 1 THEN id|1
ElSE id-1
END) AS id, student
FROM seat
ORDER BY id;
</code></pre>
<ol start="2">
<li>左连接</li>
</ol>
<pre class=" language-mysql"><code class="language-mysql">SELECT a.id,ifnull(b.student,a.student) as student 
FROM seat as a 
LEFT JOIN seat as b 
ON (a.id%2=1 && a.id=b.id-1) || (a.id%2=0 && a.id=b.id|1) 
ORDER BY a.id;
</code></pre>
<ol start="3">
<li>对id排序</li>
</ol>
<pre class=" language-mysql"><code class="language-mysql">SELECT if(id%2=0,id-1,if(id=cnt,id,id|1)) as id,student 
FROM (
       SELECT COUNT(*) as cnt FROM seat)as a,seat 
ORDER BY id;

</code></pre>
<ol start="4">
<li><p>异或</p>
<p>0^1=1 , 1^1=0 ,2^1=3 ,3^1=2  </p>
</li>
</ol>
<pre class=" language-mysql"><code class="language-mysql">SELECT b.id,a.student 
FROM seat as a,seat as b,
(SELECT COUNT(*) as cnt FROM seat) as c 
WHERE b.id=1^(a.id-1)|1 || (c.cnt%2 && b.id=c.cnt && a.id=c.cnt);
</code></pre>
<h3 id="5、体育馆的人流量-与第一题类似"><a href="#5、体育馆的人流量-与第一题类似" class="headerlink" title="5、体育馆的人流量(与第一题类似)"></a>5、体育馆的人流量(与第一题类似)</h3><h4 id="5-1、题目描述"><a href="#5-1、题目描述" class="headerlink" title="5.1、题目描述"></a>5.1、题目描述</h4><p>X 市建了一个新的体育馆，每日人流量信息被记录在这三列信息中：<code>序号 (id)</code>、<code>日期 (visit_date)</code>、 <code>人流量 (people)</code>。</p>
<p>请编写一个查询语句，找出人流量的高峰期。高峰期时，至少连续三行记录中的人流量不少于100。</p>
<p>例如，表 <code>stadium</code>：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>visit_date</th>
<th>people</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>2017-01-01</td>
<td>10</td>
</tr>
<tr>
<td>2</td>
<td>2017-01-02</td>
<td>109</td>
</tr>
<tr>
<td>3</td>
<td>2017-01-03</td>
<td>150</td>
</tr>
<tr>
<td>4</td>
<td>2017-01-04</td>
<td>99</td>
</tr>
<tr>
<td>5</td>
<td>2017-01-05</td>
<td>145</td>
</tr>
<tr>
<td>6</td>
<td>2017-01-06</td>
<td>1455</td>
</tr>
<tr>
<td>7</td>
<td>2017-01-07</td>
<td>199</td>
</tr>
<tr>
<td>8</td>
<td>2017-01-08</td>
<td>188</td>
</tr>
</tbody></table>
<p>对于上面的示例数据，输出为：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>visit_date</th>
<th>people</th>
</tr>
</thead>
<tbody><tr>
<td>5</td>
<td>2017-01-05</td>
<td>145</td>
</tr>
<tr>
<td>6</td>
<td>2017-01-06</td>
<td>1455</td>
</tr>
<tr>
<td>7</td>
<td>2017-01-07</td>
<td>199</td>
</tr>
<tr>
<td>8</td>
<td>2017-01-08</td>
<td>188</td>
</tr>
</tbody></table>
<blockquote>
<p>提示：每天只有一行记录，日期随着 id 的增加而增加。</p>
<p>来源：<a href="https://leetcode-cn.com/problems/human-traffic-of-stadium" target="_blank" rel="noopener">力扣(LeetCode)</a></p>
</blockquote>
<h4 id="5-2、解题方法"><a href="#5-2、解题方法" class="headerlink" title="5.2、解题方法"></a>5.2、解题方法</h4><p>与第一题相似，查找连续的三天，以下是最直观的思考：</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT a.*
FROM stadium as a,stadium as b,stadium as c
WHERE (a.id = b.id-1 AND b.id|1 = c.id) 
  AND (a.people>=100 AND b.people>=100 AND c.people>=100);
</code></pre>
<p>但是这样输出会有问题，比如 5,6,7,8 号人流量不少于100，但是只输出了 5,6号，根本原因在于，我们将 a 的 id 设为三个连续值中最小值，所以只返回了每 3 个连续值中最小的一个，同理可想到，我们再将 a 的 id 设为三个连续值中中间值和最大值，可以得到全部的连续 3 个值</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT a.*
FROM stadium as a,stadium as b,stadium as c
WHERE ((a.id = b.id-1 AND b.id|1 = c.id) or
       (a.id-1 = b.id AND a.id|1 = c.id) or
       (a.id-1 = c.id AND c.id-1 = b.id))
  AND (a.people>=100 AND b.people>=100 AND c.people>=100);
</code></pre>
<p>但是这样还有个问题，比如 5,6,7,8，6 既是 5,6,7 的中间值也是 6,7,8 的最小值，所以还要去重，也许 id 不按序排列，再排序 id，最终得到答案</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT DISTINCT a.*
FROM stadium as a,stadium as b,stadium as c
WHERE ((a.id = b.id-1 AND b.id|1 = c.id) or
       (a.id-1 = b.id AND a.id|1 = c.id) or
       (a.id-1 = c.id AND c.id-1 = b.id))
  AND (a.people>=100 AND b.people>=100 AND c.people>=100)
ORDER BY a.id;
</code></pre>
<h3 id="6、第N高的薪水"><a href="#6、第N高的薪水" class="headerlink" title="6、第N高的薪水"></a>6、第N高的薪水</h3><h4 id="6-1、题目描述"><a href="#6-1、题目描述" class="headerlink" title="6.1、题目描述"></a>6.1、题目描述</h4><p>编写一个 SQL 查询，获取 Employee 表中第 n 高的薪水(Salary)。</p>
<table>
<thead>
<tr>
<th>Id</th>
<th>Salary</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>5000</td>
</tr>
<tr>
<td>2</td>
<td>7000</td>
</tr>
<tr>
<td>3</td>
<td>7000</td>
</tr>
<tr>
<td>4</td>
<td>9000</td>
</tr>
<tr>
<td>5</td>
<td>9000</td>
</tr>
</tbody></table>
<p>例如上述 Employee 表，n = 2 时，应返回第二高的薪水 7000。</p>
<table>
<thead>
<tr>
<th align="left">getNthHighestSalary(2)</th>
</tr>
</thead>
<tbody><tr>
<td align="left">7000</td>
</tr>
</tbody></table>
<h4 id="6-2、解题方法"><a href="#6-2、解题方法" class="headerlink" title="6.2、解题方法"></a>6.2、解题方法</h4><ol>
<li>对薪水排序后直接查第N个</li>
</ol>
<pre class=" language-mysql"><code class="language-mysql">SELECT DISTINCT salary FROM Employee
WHERE  salary = (SELECT DISTINCT salary FROM Employee ORDER BY salary DESC LIMIT 1,1)
</code></pre>
<ol start="2">
<li>依次将最高的薪水排除</li>
</ol>
<pre class=" language-mysql"><code class="language-mysql">-- 以N=2为例
SELECT MAX(salary) FROM Employee  
WHERE salary<>(SELECT MAX(salary) FROM Employee)
</code></pre>
<ol start="3">
<li>稍微难理解一点的写法</li>
</ol>
<pre class=" language-mysql"><code class="language-mysql">SELECT DISTINCT Salary FROM Employee e 
    WHERE N = (
        SELECT COUNT(DISTINCT Salary) 
            FROM Employee 
                WHERE Salary >= e.Salary )
</code></pre>
<p>解释：用表Employee的所有不重复的Salary值A 依次与该表的所有不重复的Salary值B 进行比对，找到符合A&gt;=B条件的记录数量为N的A值。</p>
<h3 id="7、交换性别-一条语句交换两个值"><a href="#7、交换性别-一条语句交换两个值" class="headerlink" title="7、交换性别(一条语句交换两个值)"></a>7、交换性别(一条语句交换两个值)</h3><h4 id="7-1、题目描述"><a href="#7-1、题目描述" class="headerlink" title="7.1、题目描述"></a>7.1、题目描述</h4><p>给定一个 salary 表，如下所示，有 m = 男性 和 f = 女性 的值。交换所有的 f 和 m 值(例如，将所有 f 值更改为 m，反之亦然)。要求只使用一个更新(Update)语句，并且没有中间的临时表。</p>
<p>注意，您必只能写一个 Update 语句，请不要编写任何 Select 语句。</p>
<p>例如：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>sex</th>
<th>salary</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>A</td>
<td>m</td>
<td>2500</td>
</tr>
<tr>
<td>2</td>
<td>B</td>
<td>f</td>
<td>1500</td>
</tr>
<tr>
<td>3</td>
<td>C</td>
<td>m</td>
<td>5500</td>
</tr>
<tr>
<td>4</td>
<td>D</td>
<td>f</td>
<td>500</td>
</tr>
</tbody></table>
<p>运行你所编写的更新语句之后，将会得到以下表:</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>sex</th>
<th>salary</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>A</td>
<td>f</td>
<td>2500</td>
</tr>
<tr>
<td>2</td>
<td>B</td>
<td>m</td>
<td>1500</td>
</tr>
<tr>
<td>3</td>
<td>C</td>
<td>f</td>
<td>5500</td>
</tr>
<tr>
<td>4</td>
<td>D</td>
<td>m</td>
<td>500</td>
</tr>
</tbody></table>
<blockquote>
<p>来源：<a href="https://leetcode-cn.com/problems/swap-salary" target="_blank" rel="noopener">力扣(LeetCode)</a></p>
</blockquote>
<h4 id="7-2、解题方法"><a href="#7-2、解题方法" class="headerlink" title="7.2、解题方法"></a>7.2、解题方法</h4><ol>
<li>CASE WHEN</li>
</ol>
<pre class=" language-mysql"><code class="language-mysql">UPDATE salary
SET
sex = CASE sex
WHEN 'm' THEN 'f'
ELSE 'm'
END;
</code></pre>
<ol start="2">
<li>if</li>
</ol>
<pre class=" language-mysql"><code class="language-mysql">update salary set sex=if(sex = 'f', 'm','f');
</code></pre>
<ol start="3">
<li>ASCII码转换</li>
</ol>
<pre class=" language-mysql"><code class="language-mysql">update salary set sex = char(ascii('m') + ascii('f') - ascii(sex));
</code></pre>
<h3 id="8、行程和用户"><a href="#8、行程和用户" class="headerlink" title="8、行程和用户"></a>8、行程和用户</h3><h4 id="8-1、题目描述"><a href="#8-1、题目描述" class="headerlink" title="8.1、题目描述"></a>8.1、题目描述</h4><p><code>Trips</code> 表中存所有出租车的行程信息。每段行程有唯一键 <code>Id</code>，<code>Client_Id</code> 和 <code>Driver_Id</code> 是 <code>Users</code> 表中 <code>Users_Id</code> 的外键。<code>Status</code> 是枚举类型，枚举成员为 (‘completed’, ‘cancelled_by_driver’, ‘cancelled_by_client’)。</p>
<table>
<thead>
<tr>
<th>Id</th>
<th>Client_Id</th>
<th>Driver_Id</th>
<th>City_Id</th>
<th>Status</th>
<th>Request_at</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>1</td>
<td>10</td>
<td>1</td>
<td>completed</td>
<td>2013-10-01</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>11</td>
<td>1</td>
<td>cancelled_by_driver</td>
<td>2013-10-01</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
<td>12</td>
<td>6</td>
<td>completed</td>
<td>2013-10-01</td>
</tr>
<tr>
<td>4</td>
<td>4</td>
<td>13</td>
<td>6</td>
<td>cancelled_by_client</td>
<td>2013-10-01</td>
</tr>
<tr>
<td>5</td>
<td>1</td>
<td>10</td>
<td>1</td>
<td>completed</td>
<td>2013-10-02</td>
</tr>
<tr>
<td>6</td>
<td>2</td>
<td>11</td>
<td>6</td>
<td>completed</td>
<td>2013-10-02</td>
</tr>
<tr>
<td>7</td>
<td>3</td>
<td>12</td>
<td>6</td>
<td>completed</td>
<td>2013-10-02</td>
</tr>
<tr>
<td>8</td>
<td>2</td>
<td>12</td>
<td>12</td>
<td>completed</td>
<td>2013-10-03</td>
</tr>
<tr>
<td>9</td>
<td>3</td>
<td>10</td>
<td>12</td>
<td>completed</td>
<td>2013-10-03</td>
</tr>
<tr>
<td>10</td>
<td>4</td>
<td>13</td>
<td>12</td>
<td>cancelled_by_driver</td>
<td>2013-10-03</td>
</tr>
</tbody></table>
<p><code>Users</code> 表存所有用户。每个用户有唯一键 <code>Users_Id</code>。<code>Banned</code> 表示这个用户是否被禁止，<code>Role</code> 则是一个表示(‘client’, ‘driver’, ‘partner’)的枚举类型。</p>
<table>
<thead>
<tr>
<th>Users_Id</th>
<th>Banned</th>
<th>Role</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>No</td>
<td>client</td>
</tr>
<tr>
<td>2</td>
<td>Yes</td>
<td>client</td>
</tr>
<tr>
<td>3</td>
<td>No</td>
<td>client</td>
</tr>
<tr>
<td>4</td>
<td>No</td>
<td>client</td>
</tr>
<tr>
<td>10</td>
<td>No</td>
<td>driver</td>
</tr>
<tr>
<td>11</td>
<td>No</td>
<td>driver</td>
</tr>
<tr>
<td>12</td>
<td>No</td>
<td>driver</td>
</tr>
<tr>
<td>13</td>
<td>No</td>
<td>driver</td>
</tr>
</tbody></table>
<p>写一段 SQL 语句查出 2013年10月1日 至 2013年10月3日 期间非禁止用户的取消率。基于上表，你的 SQL 语句应返回如下结果，取消率(Cancellation Rate)保留两位小数。</p>
<p>取消率的计算方式如下：(被司机或乘客取消的非禁止用户生成的订单数量) / (非禁止用户生成的订单总数)</p>
<table>
<thead>
<tr>
<th>Day</th>
<th>Cancellation Rate</th>
</tr>
</thead>
<tbody><tr>
<td>2013-10-01</td>
<td>0.33</td>
</tr>
<tr>
<td>2013-10-02</td>
<td>0.00</td>
</tr>
<tr>
<td>2013-10-03</td>
<td>0.50</td>
</tr>
</tbody></table>
<blockquote>
<p>来源：<a href="https://leetcode-cn.com/problems/trips-AND-users" target="_blank" rel="noopener">力扣(LeetCode)</a></p>
</blockquote>
<h4 id="8-2、解题方法"><a href="#8-2、解题方法" class="headerlink" title="8.2、解题方法"></a>8.2、解题方法</h4><pre class=" language-mysql"><code class="language-mysql">SELECT a.Request_at as Day,
round(sum(case status when 'completed' then 0 else 1 end)/COUNT(*),2) as 'CancellatiON Rate'  
FROM Trips a 
        LEFT JOIN Users b ON a.Client_Id  =b.Users_Id  
        LEFT JOIN Users c ON a.Driver_Id  =c.Users_Id  
            WHERE a.Request_at between '2013-10-01' AND '2013-10-03'
                AND b.Banned ='No' AND c.Banned ='No'
                    GROUP BY a.Request_at
</code></pre>
<h3 id="9、上升的温度"><a href="#9、上升的温度" class="headerlink" title="9、上升的温度"></a>9、上升的温度</h3><h4 id="9-1、题目描述"><a href="#9-1、题目描述" class="headerlink" title="9.1、题目描述"></a>9.1、题目描述</h4><p>给定一个 <code>Weather</code> 表，编写一个 SQL 查询，来查找与之前(昨天的)日期相比温度更高的所有日期的 <code>Id</code>。</p>
<table>
<thead>
<tr>
<th>Id(INT)</th>
<th>RecordDate(DATE)</th>
<th>Temperature(INT)</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>2015-01-01</td>
<td>10</td>
</tr>
<tr>
<td>2</td>
<td>2015-01-02</td>
<td>25</td>
</tr>
<tr>
<td>3</td>
<td>2015-01-03</td>
<td>20</td>
</tr>
<tr>
<td>4</td>
<td>2015-01-04</td>
<td>30</td>
</tr>
</tbody></table>
<p>例如，根据上述给定的 <code>Weather</code> 表格，返回如下 Id:</p>
<table>
<thead>
<tr>
<th>Id</th>
</tr>
</thead>
<tbody><tr>
<td>2</td>
</tr>
<tr>
<td>4</td>
</tr>
</tbody></table>
<blockquote>
<p>来源：<a href="https://leetcode-cn.com/problems/rising-temperature" target="_blank" rel="noopener">力扣(LeetCode)</a></p>
</blockquote>
<h4 id="9-2、解题方法"><a href="#9-2、解题方法" class="headerlink" title="9.2、解题方法"></a>9.2、解题方法</h4><p>1、直接使用日期加减然后关联</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT w1.Id
FROM Weather w1 JOIN Weather w2
ON w1.RecordDate = w2.RecordDate+1
WHERE w1.Temperature > w2.Temperature
</code></pre>
<p>2、使用<code>datediff</code>函数</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT
weather.id AS 'Id'
FROM
weather
JOIN
weather w ON DATEDIFF(weather.date, w.date) = 1
AND weather.Temperature > w.Temperature

</code></pre>
<h3 id="10、分数排名-经典的排名问题"><a href="#10、分数排名-经典的排名问题" class="headerlink" title="10、分数排名(经典的排名问题)"></a>10、分数排名(经典的排名问题)</h3><h4 id="10-1、题目描述"><a href="#10-1、题目描述" class="headerlink" title="10.1、题目描述"></a>10.1、题目描述</h4><p>编写一个 SQL 查询来实现分数排名。如果两个分数相同，则两个分数排名(<code>Rank</code>)相同。请注意，平分后的下一个名次应该是下一个连续的整数值。换句话说，名次之间不应该有“间隔”。</p>
<table>
<thead>
<tr>
<th>Id</th>
<th>Score</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>3.50</td>
</tr>
<tr>
<td>2</td>
<td>3.65</td>
</tr>
<tr>
<td>3</td>
<td>4.00</td>
</tr>
<tr>
<td>4</td>
<td>3.85</td>
</tr>
<tr>
<td>5</td>
<td>4.00</td>
</tr>
<tr>
<td>6</td>
<td>3.65</td>
</tr>
</tbody></table>
<p>例如，根据上述给定的 <code>Scores</code> 表，你的查询应该返回(按分数从高到低排列)：</p>
<table>
<thead>
<tr>
<th>Score</th>
<th>Rank</th>
</tr>
</thead>
<tbody><tr>
<td>4.00</td>
<td>1</td>
</tr>
<tr>
<td>4.00</td>
<td>1</td>
</tr>
<tr>
<td>3.85</td>
<td>2</td>
</tr>
<tr>
<td>3.65</td>
<td>3</td>
</tr>
<tr>
<td>3.65</td>
<td>3</td>
</tr>
<tr>
<td>3.50</td>
<td>4</td>
</tr>
</tbody></table>
<blockquote>
<p>来源：<a href="https://leetcode-cn.com/problems/rank-scores" target="_blank" rel="noopener">力扣(LeetCode)</a></p>
</blockquote>
<h4 id="10-2、解题方法"><a href="#10-2、解题方法" class="headerlink" title="10.2、解题方法"></a>10.2、解题方法</h4><p>1、直接使用SQL书写</p>
<pre class=" language-mysql"><code class="language-mysql">SELECT a.Score as Score,
(SELECT COUNT(DISTINCT b.Score) FROM Scores b WHERE b.Score >= a.Score) as Rank
FROM Scores a
ORDER BY a.Score DESC
</code></pre>
<p>2、使用开窗函数</p>

            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://yuhaowang.top" rel="external nofollow noreferrer">Yuhao Wang</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://yuhaowang.top/2020/02/26/SQL%E9%A2%98%E7%9B%AE%E4%B8%8E%E8%A7%A3%E6%9E%90/">http://yuhaowang.top/2020/02/26/SQL%E9%A2%98%E7%9B%AE%E4%B8%8E%E8%A7%A3%E6%9E%90/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="http://yuhaowang.top" target="_blank">Yuhao Wang</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/SQL/">
                                    <span class="chip bg-color">SQL</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            
        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/2020/02/26/SQL%E9%A2%98%E7%9B%AE%E4%B8%8E%E8%A7%A3%E6%9E%90/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/17.jpg" class="responsive-img" alt="SQL题目与解析">
                        
                        <span class="card-title">SQL题目与解析</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            总结一部分SQL题目与解题方式
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-02-26
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/SQL/" class="post-category">
                                    SQL
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/SQL/">
                        <span class="chip bg-color">SQL</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2020/02/14/2020%E5%B9%B4%E6%8A%95%E8%B5%84%E8%AE%B0%E5%BD%95/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/7.jpg" class="responsive-img" alt="2020年理财记录">
                        
                        <span class="card-title">2020年理财记录</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            记录下自己2020年的理财历程
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-02-14
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%90%86%E8%B4%A2/" class="post-category">
                                    理财
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E7%90%86%E8%B4%A2/">
                        <span class="chip bg-color">理财</span>
                    </a>
                    
                    <a href="/tags/%E5%9F%BA%E9%87%91/">
                        <span class="chip bg-color">基金</span>
                    </a>
                    
                    <a href="/tags/%E8%82%A1%E7%A5%A8/">
                        <span class="chip bg-color">股票</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 从来只看自己<br />'
            + '文章作者: Yuhao Wang<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>

    
<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>

    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('4'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>


<script src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\(', '\)']]}
    });
</script>


    <footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">年份</span>
            <a href="http://yuhaowang.top" target="_blank">Yuhao Wang</a>

            
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">59.1k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    window.setTimeout("siteTime()", 1000);
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2019";
                    var startMonth = "12";
                    var startDate = "5";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/RomanticDW" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:88079031@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=88079031" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 88079031" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->


    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    

    

    
    
    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
